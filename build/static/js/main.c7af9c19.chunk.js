(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,t,i){e.exports=i(26)},20:function(e,t,i){},21:function(e,t,i){},24:function(e,t,i){e.exports=i.p+"static/media/heart.0532cfb2.svg"},25:function(e,t,i){e.exports=i.p+"static/media/pill.29c71f60.svg"},26:function(e,t,i){"use strict";i.r(t);var n=i(3),o=i.n(n),s=i(13),r=i.n(s),a=(i(20),i(1)),l=i(2),d=i(6),h=i(4),c=i(7),u=(i(21),i(8)),y=i.n(u),f=i(9),p=i(0),g="#ff0040",b="#272727",m="#c42430",w="#7a09fa",v="#5ac54f",x="#94fdff",B="#e07438",S="#FFF",k=i(5),D=new k.Howl({src:["./sounds/bow.wav"]}),T=function(){function e(t,i){var n=t.engine,o=i.x,s=i.y;Object(a.a)(this,e),this.state={},this.engine=n,this.radius=20,this.color=g,this.body=p.Bodies.circle(o,s,this.radius,{label:"player",render:{fillStyle:this.color},lifes:3}),this.effects={ultimate:!1},this.ts={shot:+new Date,ultimate:+new Date},this.ulti=!1}return Object(l.a)(e,[{key:"moveToDirection",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;t=this.effects.fatpill?4:t,p.Body.setVelocity(this.body,{x:e.x*t,y:e.y*t})}},{key:"activateEffect",value:function(e){var t=this,i=+new Date;"bigshot"===e.id&&(this.effects[e.id]=!0,this.ts[e.id]=+new Date),"ultimate"===e.id&&i-this.ts[e.id]>1e4&&(this.recentColor=this.body.render.fillStyle,this.body.render.fillStyle="#f68187",p.Body.scale(this.body,.5,.5),this.effects[e.id]=!0,this.ts[e.id]=+new Date,setTimeout(function(){return t.deactivateEffect(e)},1e3)),"fatpill"===e.id&&(this.recentColor=this.body.render.fillStyle,this.body.render.fillStyle="#7a09fa",this.effects[e.id]=!0,this.ts[e.id]=+new Date)}},{key:"deactivateEffect",value:function(e){this.effects[e.id]=!1,"ultimate"===e.id&&(this.body.render.fillStyle=this.color,p.Body.scale(this.body,2,2)),"fatpill"===e.id&&(this.body.render.fillStyle=this.color)}},{key:"deactivateEffects",value:function(){var e=this;console.log(Object.keys(this.effects).filter(function(t){return!!e.effects[t]})),Object.keys(this.effects).filter(function(t){return!!e.effects[t]}).forEach(function(t){return e.deactivateEffect({id:t})})}},{key:"fireBulletToDirection",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3.5,n=this.effects.bigshot?10:5,o=this.radius+n,s=p.Bodies.circle(this.body.position.x+o*e.x,this.body.position.y+o*e.y,n,{label:"bullet-player",static:!0});s.frictionAir=0,this.effects.ultimate&&(s.render.fillStyle="#f5555d"),p.Body.setVelocity(s,{x:e.x*i,y:e.y*i}),p.World.add(this.engine.world,[s]),setTimeout(function(){return p.Composite.remove(t.engine.world,s)},2e3)}},{key:"fire",value:function(e){var t=+new Date,i=this.effects.ultimate?10:300;t-this.ts.shot>i&&(D.play(),this.fireBulletToDirection(e),this.ts.shot=+new Date)}},{key:"update",value:function(){}},{key:"addToWorld",value:function(){p.World.add(this.engine.world,[this.body])}},{key:"removeFromWorld",value:function(){p.Composite.remove(this.engine.world,this.body)}}]),e}(),O=i(14),j=new(function(){function e(){Object(a.a)(this,e)}return Object(l.a)(e,[{key:"getState",value:function(){var e=navigator.getGamepads();if(Object(O.a)(e).filter(function(e){return null!==e}).length<1)return{connected:!1};var t=e[0];return{connected:!0,buttons:t.buttons.map(function(e,t){return{index:t,pressed:e.pressed,value:e.value}}),axes:t.axes}}}]),e}()),E=function(){function e(t,i){var n=t.engine,o=t.render,s=i.onDeath;Object(a.a)(this,e),this.engine=n,this.render=o,this.counter=0,this.dead=!1,this.onDeath=s}return Object(l.a)(e,[{key:"fireBulletToBody",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3.5,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;this.fireBulletToPosition(e.position,t,i)}},{key:"fireBulletToPosition",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3.5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;if(isNaN(e.x)||isNaN(e.y))throw new Error("position coordinates missing");var o=e.x-this.body.position.x,s=e.y-this.body.position.y,r=Math.sqrt(Math.pow(o,2)+Math.pow(s,2)),a=(this.radius||this.width)+5+20,l={x:this.body.position.x+a*(o/r),y:this.body.position.y+a*(s/r)},d=p.Bodies.circle(l.x,l.y,5,{label:"bullet-enemy"});d.frictionAir=0,p.Body.setVelocity(d,{x:o/r*i,y:s/r*i}),p.World.add(this.engine.world,[d]),setTimeout(function(){return p.Composite.remove(t.engine.world,d)},n)}},{key:"fireBulletToDirection",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3.5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;if(isNaN(e.x)||isNaN(e.y))throw new Error("position coordinates missing");var o=(this.radius||this.width)+3+20,s={x:this.body.position.x+o*e.x,y:this.body.position.y+o*e.y},r=p.Bodies.circle(s.x,s.y,3,{label:"bullet-enemy",static:!0});r.frictionAir=0,p.World.add(this.engine.world,[r]),p.Body.setVelocity(r,{x:e.x*i,y:e.y*i}),setTimeout(function(){return p.Composite.remove(t.engine.world,r)},n)}},{key:"fireBulletRectangle",value:function(){this.fireBulletToDirection({x:-1,y:0},5),this.fireBulletToDirection({x:1,y:0},5),this.fireBulletToDirection({x:0,y:-1},5),this.fireBulletToDirection({x:0,y:1},5)}},{key:"fireBulletStar",value:function(){this.fireBulletToDirection({x:-1,y:0},5),this.fireBulletToDirection({x:1,y:0},5),this.fireBulletToDirection({x:0,y:-1},5),this.fireBulletToDirection({x:0,y:1},5)}},{key:"moveToBody",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=e.position.x-this.body.position.x,n=e.position.y-this.body.position.y,o=Math.sqrt(Math.pow(i,2)+Math.pow(n,2));p.Body.setVelocity(this.body,{x:i/o*t,y:n/o*t})}},{key:"moveToDirection",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];p.Body.setVelocity(this.body,{x:e.x,y:e.y})}},{key:"update",value:function(e){this.counter+=1}},{key:"die",value:function(){this.dead=!0,p.Composite.remove(this.engine.world,this.body)}},{key:"addToWorld",value:function(){p.World.add(this.engine.world,[this.body])}}]),e}();function R(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}var M=function(e){function t(e,i){var n,o=e.engine,s=i.x,r=i.y;return Object(a.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).apply(this,arguments))).state={},n.engine=o,n.radius=15,n.body=p.Bodies.circle(s,r,n.radius,{label:"enemy",lifes:5,render:{fillStyle:x}}),n.lastMove=+new Date,n.lastShot=+new Date,n}return Object(c.a)(t,e),Object(l.a)(t,[{key:"update",value:function(e){var t=e[R(0,e.length-1)],i=+new Date;t&&(i-this.lastShot>2e3&&(this.lastShot=+new Date,this.fireBulletToBody(t.body)),i-this.lastMove>5e3&&(this.lastMove=+new Date,Math.random()<.3?this.moveToBody(t.body):this.moveToDirection({x:Math.random(),y:Math.random()})))}}]),t}(E),C=function(e){function t(e,i){var n,o=e.engine,s=i.x,r=i.y;return Object(a.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).apply(this,arguments))).state={},n.engine=o,n.radius=10,n.body=p.Bodies.circle(s,r,n.radius,{label:"enemy",lifes:1,isStatic:!0,render:{fillStyle:B}}),n.lastShot1=+new Date,n.lastShot2=+new Date,n}return Object(c.a)(t,e),Object(l.a)(t,[{key:"update",value:function(e){var t=+new Date;t-this.lastShot1>500&&(this.lastShot1=+new Date,this.fireBulletStar()),t-this.lastShot2>1e3&&(this.lastShot2=+new Date,this.fireBulletToDirection({x:R(-1,1),y:1},2),this.fireBulletToDirection({x:R(-1,1),y:-1},2))}}]),t}(E),W=i(11),P=function(e){function t(e,i){e.engine,e.render;var n,o=i.x,s=i.y;Object(a.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).apply(this,arguments))).width=40,n.height=40,n.body=p.Bodies.rectangle(o,s,n.width,n.height,{label:"enemy",lifes:20,render:{fillStyle:S}});var r=[R(0,5),R(0,5),R(0,5)];return n.directionIndex=0,n.directionPathsIndex=0,n.directionPaths=[[{x:0,y:2},{x:0,y:2},{x:0,y:2},{x:-2,y:0},{x:-2,y:0},{x:-2,y:0},{x:-2,y:0}],[{x:r[0],y:-r[0]},{x:r[1],y:-r[1]},{x:r[2],y:-r[2]},{x:r[0],y:-r[0]}]],n.directions=n.lastShot1=+new Date,n.lastShot2=+new Date,n}return Object(c.a)(t,e),Object(l.a)(t,[{key:"update",value:function(e){var i=this;Object(W.a)(Object(h.a)(t.prototype),"update",this).call(this);var n=e[R(0,e.length-1)],o=+new Date;if(this.counter>=60){this.counter=0,p.Body.setAngularVelocity(this.body,.02);var s=this.directionPaths[this.directionPathsIndex],r=s[this.directionIndex];p.Body.setVelocity(this.body,r),this.directionIndex+=1,this.directionIndex>s.length-1&&(this.directionIndex=0,this.directionPathsIndex+=1,this.directionPathsIndex>this.directionPaths.length-1&&(this.directionPathsIndex=0))}if(n){o-this.lastShot2>500&&(this.lastShot2=+new Date,this.fireBulletToBody(n.body,3.5,2e3));var a=1e3*this.body.lifes/3;o-this.lastShot1>a&&(p.Body.setAngularVelocity(this.body,.05),this.lastShot1=+new Date,this.fireBulletStar(),this.fireBulletRectangle(),this.body.lifes<3&&this.moveToBody(n.body),p.Body.scale(this.body,2,2),setTimeout(function(){return p.Body.scale(i.body,.5,.5)},200))}}},{key:"die",value:function(){var e=this;Object(W.a)(Object(h.a)(t.prototype),"die",this).call(this);for(var i=0;i<100;i++)this.fireBulletToDirection({x:Math.random(),y:Math.random()},3,4e3);this.engine.timing.timeScale=.1,setTimeout(function(){return e.engine.timing.timeScale=1},1e4)}}]),t}(E),I=function(){function e(t,i){var n=t.engine,o=i.x,s=i.y,r=i.type;Object(a.a)(this,e),this.state={},this.engine=n;var l={life:{color:m},fatpill:{color:w},bigshot:{color:v}}[r];this.width=15,this.height=15,this.body=p.Bodies.rectangle(o,s,this.width,this.height,{label:"item",itemType:r,render:{fillStyle:l.color},chamfer:{radius:3}})}return Object(l.a)(e,[{key:"update",value:function(){}},{key:"addToWorld",value:function(){p.World.add(this.engine.world,[this.body])}}]),e}(),H=function(){function e(t,i){var n=t.engine,o=t.render,s=i.type,r=i.targetRoom;Object(a.a)(this,e),this.state={},this.engine=n;var l={right:{x:o.options.width,y:o.options.height/2,width:50,height:100},left:{x:0,y:o.options.height/2,width:50,height:100},top:{x:o.options.width/2,y:0,width:100,height:50},bottom:{x:o.options.width/2,y:o.options.height,width:100,height:50}}[s],d=l.x,h=l.y,c=l.width,u=l.height;this.body=p.Bodies.rectangle(d,h,c,u,{isStatic:!0,label:"door",doorType:s,targetRoom:r,render:{fillStyle:b},locked:!0})}return Object(l.a)(e,[{key:"unlock",value:function(){this.body.render.fillStyle="#3d3d3d",this.body.locked=!1}},{key:"update",value:function(){}},{key:"addToWorld",value:function(){p.World.add(this.engine.world,[this.body])}}]),e}();i(24),i(25);function N(e){return V.apply(this,arguments)}function V(){return(V=Object(f.a)(y.a.mark(function e(t){var i,n,o,s;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.engine,n=t.render,o=t.width,s=t.height,e.abrupt("return",{0:{enemies:[],items:[new I({engine:i,render:n},{type:"fatpill",x:R(100,o-100),y:R(100,s-100)}),new I({engine:i,render:n},{type:"life",x:R(100,o-100),y:R(100,s-100)})],doors:[new H({engine:i,render:n},{targetRoom:1,type:"left"})]},1:{enemies:[new C({engine:i,render:n},{x:o-100,y:100}),new C({engine:i,render:n},{x:R(100,o-100),y:R(100,s-100)}),new C({engine:i,render:n},{x:R(100,o-100),y:R(100,s-100)})],items:[],doors:[new H({engine:i,render:n},{targetRoom:0,type:"right"}),new H({engine:i,render:n},{targetRoom:2,type:"bottom"}),new H({engine:i,render:n},{targetRoom:3,type:"left"})]},2:{enemies:[new P({engine:i,render:n},{x:o-100,y:s-100}),new M({engine:i,render:n},{x:R(100,o-100),y:R(100,s-100)})],items:[new I({engine:i,render:n},{type:"fatpill",x:R(100,o-100),y:R(100,s-100)}),new I({engine:i,render:n},{type:"life",x:R(100,o-100),y:R(100,s-100)}),new I({engine:i,render:n},{type:"life",x:R(100,o-100),y:R(100,s-100)})],doors:[new H({engine:i,render:n},{targetRoom:1,type:"top"})]},3:{enemies:[new C({engine:i,render:n},{x:100,y:100}),new M({engine:i,render:n},{x:R(100,o-100),y:R(100,s-100)}),new M({engine:i,render:n},{x:R(100,o-100),y:R(100,s-100)}),new M({engine:i,render:n},{x:R(100,o-100),y:R(100,s-100)}),new C({engine:i,render:n},{x:o-100,y:s-100})],items:[new I({engine:i,render:n},{type:"bigshot",x:R(100,o-100),y:R(100,s-100)}),new I({engine:i,render:n},{type:"life",x:R(100,o-100),y:R(100,s-100)})],doors:[new H({engine:i,render:n},{targetRoom:1,type:"right"})]}});case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}var A=new k.Howl({src:["./sounds/bubble.wav"]}),F=new k.Howl({src:["./sounds/bottle.wav"]}),U=new k.Howl({src:["./sounds/door.wav"]}),q=new k.Howl({src:["./sounds/bg.mp3"],loop:!0}),J=new k.Howl({src:["./sounds/selection.wav"]}),G=new k.Howl({src:["./sounds/pain.wav"]}),L=(new k.Howl({src:["./sounds/pain.wav"]}),new k.Howl({src:["./sounds/victory.mp3"]})),$=new k.Howl({src:["./sounds/vic.mp3"]}),z=new k.Howl({src:["./sounds/hit.mp3"]}),K=function(e){function t(e){var i;return Object(a.a)(this,t),(i=Object(d.a)(this,Object(h.a)(t).call(this,e))).width=800,i.height=600,i.state={lifes:null,gameover:!0},i.players=[],i.rooms=null,i.currentRoomId=0,i.renderElement=o.a.createElement("div",{style:{width:"100%",height:"100%"}}),i}return Object(c.a)(t,e),Object(l.a)(t,[{key:"cleanRoom",value:function(){p.World.clear(this.engine.world)}},{key:"setupRoom",value:function(e){p.World.add(this.engine.world,[p.Bodies.rectangle(400,0,800,50,{isStatic:!0,label:"wall",render:{fillStyle:"#1b1b1b"}}),p.Bodies.rectangle(400,600,800,50,{isStatic:!0,label:"wall",render:{fillStyle:"#1b1b1b"}}),p.Bodies.rectangle(800,300,50,600,{isStatic:!0,label:"wall",render:{fillStyle:"#1b1b1b"}}),p.Bodies.rectangle(0,300,50,600,{isStatic:!0,label:"wall",render:{fillStyle:"#1b1b1b"}})]),this.currentRoomId=e.id;var t=this.rooms[this.currentRoomId];this.players.forEach(function(t){t.addToWorld(),p.Body.setPosition(t.body,{x:e.playerPosition.x,y:e.playerPosition.y})}),t.doors.forEach(function(e){return e.addToWorld()}),t.items.forEach(function(e){return e.addToWorld()}),t.enemies.forEach(function(e){return e.addToWorld()}),0===t.enemies.length&&t.doors.forEach(function(e){return e.unlock()})}},{key:"update",value:function(){var e=this,t=j.getState();if((this.setState({gamepadConnected:t.connected}),t.connected)&&(this.setState({gamepadStr:JSON.stringify(t,null,2)}),this.state.gameover&&t.buttons[8].pressed&&(this.players=[],this.setState({fatpill:!1}),this.start()),null!==this.rooms&&!this.state.loading&&(this.rooms[this.currentRoomId].enemies.forEach(function(t){return t.update(e.players)}),this.players.forEach(function(e){return e.update()}),!this.state.gameover))){var i=this.players[0];t.buttons[9].pressed,t.buttons[7].pressed&&(i.activateEffect({id:"ultimate"}),this.setState({lastUlti:+new Date})),(Math.abs(t.axes[3])>.95||Math.abs(t.axes[4])>.95)&&i.fire({x:t.axes[3],y:t.axes[4]}),i.moveToDirection({x:t.axes[0],y:t.axes[1]})}}},{key:"setupCollisions",value:function(){var e=this;p.Events.on(this.engine,"collisionStart",function(t){var i=e.rooms[e.currentRoomId];t.pairs.forEach(function(t){var n=t.bodyA,o=t.bodyB;if("enemy"===n.label&&"bullet-player"===o.label){if(z.play(),n.lifes-=1,p.Composite.remove(e.engine.world,o),n.lifes<=0){$.play();for(var s=0;s<i.enemies.length;s++)if(i.enemies[s].body.id===n.id){i.enemies[s].die(),i.enemies.splice(s,1);break}}0===i.enemies.length&&(L.play(),i.doors.map(function(e){return e.unlock()}))}if("player"===n.label&&"bullet-enemy"===o.label&&(z.play(),p.Composite.remove(e.engine.world,o),n.lifes-=1,e.setState({lifes:n.lifes}),n.lifes<=0&&(G.play(),p.Composite.remove(e.engine.world,n),e.players=[],e.setState({gameover:!0}))),"wall"===n.label&&["bullet-player","bullet-enemy"].includes(o.label)&&p.Composite.remove(e.engine.world,o),"player"===n.label&&"door"===o.label||"door"===n.label&&"player"===o.label){var r="player"===n.label?o:n;r.locked||(U.play(),e.cleanRoom(),e.setupRoom({id:r.targetRoom,playerPosition:{left:{x:e.width-100,y:e.height/2},right:{x:100,y:e.height/2},top:{x:e.width/2,y:e.height-100},bottom:{x:e.width/2,y:100}}[r.doorType]}))}if("item"===n.label&&"player"===o.label||"player"===n.label&&"item"===o.label){var a="item"===n.label?n:o,l="player"===n.label?n:o;p.Composite.remove(e.engine.world,a),"fatpill"===a.itemType&&(F.play(),e.players[0].activateEffect({id:"fatpill"}),l.lifes=1,e.setState({fatpill:!0,lifes:l.lifes})),"life"===a.itemType&&(A.play(),e.setState({lifes:e.state.lifes+1}),l.lifes+=1),"bigshot"===a.itemType&&e.players[0].activateEffect({id:"bigshot"});for(var d=0;d<i.items.length;d++)if(i.items[d].body.id===a.id||i.items[d].body.id===a.parent.id){i.items.splice(d,1);break}}})})}},{key:"componentDidMount",value:function(){this.engine=p.Engine.create(),this.engine.world.gravity.y=0,p.Engine.run(this.engine),this.renderer=p.Render.create({element:this.renderElement,engine:this.engine,options:{width:this.width,height:this.height,wireframes:!1,background:"#131313"}}),p.Render.run(this.renderer),function e(){this.update(this.engine),window.requestAnimationFrame(e.bind(this)),p.Engine.update(this.engine,1e3/60)}.bind(this)()}},{key:"start",value:function(){var e=Object(f.a)(y.a.mark(function e(){var t;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return J.play(),q.stop(),q.play(),t=new T({engine:this.engine,render:this.render},{x:this.width/2,y:this.height/2}),this.players.push(t),p.Engine.clear(this.engine),this.setState({loading:!0,lastUlti:+new Date,lifes:t.body.lifes,gameover:!1}),e.next=9,N({engine:this.engine,render:this.renderer,width:this.width,height:this.height});case 9:this.rooms=e.sent,this.setupCollisions(),this.cleanRoom(),this.setupRoom({id:0,playerPosition:{x:this.width/2,y:this.height/2}}),this.setState({loading:!1});case 14:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement("div",{style:{position:"absolute"}},this.state.gamepadConnected&&!this.state.loading&&!this.state.gameover&&o.a.createElement("div",null,function(e){for(var t=[],i=0;i<e;i++)t.push(0);return t}(this.state.lifes).map(function(t){return e.state.fatpill?"\ud83d\udc9c":"\u2764\ufe0f"}),+new Date-this.state.lastUlti>=1e4&&"\ud83d\udc8a",+new Date-this.state.lastUlti<1e4&&10-Math.round((+new Date-this.state.lastUlti)/1e3)),!this.state.gamepadConnected&&o.a.createElement("code",null,"Please connect gamepad"),this.state.gamepadConnected&&this.state.loading&&o.a.createElement("code",null,"Loading\u2026"),this.state.gamepadConnected&&this.state.gameover&&!this.state.loading&&o.a.createElement("code",null,"Press the 'start' button")),o.a.createElement("div",{style:{width:"100%",height:"100%",textAlign:"center"},ref:function(t){return e.renderElement=t}}))}}]),t}(n.Component),Q=function(e){function t(){return Object(a.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement(K,null)}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(Q,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[15,1,2]]]);
//# sourceMappingURL=main.c7af9c19.chunk.js.map